(this["webpackJsonplienquan-mina"]=this["webpackJsonplienquan-mina"]||[]).push([[0],{116:function(e,t,a){"use strict";a.r(t);var i=a(13),n=a.n(i),r=a(18),s=a(0),o=(a(80),a(5)),c=function e(){Object(o.a)(this,e)};c.WORLD_WIDTH=500,c.WORLD_HEIGHT=1e3,c.PLAYER_WIDTH=150,c.PLAYER_HEIGHT=150,c.PLAYER_DRAW_WIDTH=2*c.PLAYER_WIDTH,c.PLAYER_DRAW_HEIGHT=2*c.PLAYER_HEIGHT,c.PLAYER_SPEED_Y=-400,c.PLAYER_DASH_SPEED=600,c.PLAYER_KNOCKBACK_FORCE=800,c.PLAYER_X_TARGETS=[.25*c.WORLD_WIDTH,.75*c.WORLD_WIDTH],c.BACKGROUND_START=-(c.WORLD_HEIGHT-(c.CAMERA_GAP=.8*c.WORLD_HEIGHT)),c.BACKGROUND_ASPECT_RATIO=.6,c.BACKGROUND_HEIGHT=(c.BACKGROUND_WIDTH=c.WORLD_WIDTH)/c.BACKGROUND_ASPECT_RATIO,c.LEVEL_COUNT=30,c.DASH_SMOKE_SIZE=120,c.DASH_SMOKE_DURATION=.4,c.ENEMY_RADIUS=150,c.ENEMY_SPEED_Y=100,c.ROCK_RADIUS=100,c.BOSS_X=c.WORLD_WIDTH/2,c.BOSS_Y=c.BACKGROUND_START-(c.LEVEL_COUNT-1)*c.BACKGROUND_HEIGHT+160,c.BOSS_ATTACK_RATE=.8,c.BOSS_PROJECTILE_COUNT=20,c.MIN_POWER=.5,c.MAX_POWER=3,c.POWER_INC=.25,c.POWER_DEC=.1,c.POWER_DEC_RATE=.1,c.KNOCKBACK_DURATION=.2;var l,h,b,u,O,p,d,y,j,m,S,f,g,A,_,R,E,T,v,w,D,I,H,L,P,M,x,C,W,G,N,k,K,B,Y,z,U,F,X,V,J,Z,q,Q,$,ee,te,ae,ie,ne,re,se,oe,ce,le,he,be,ue,Oe,pe,de,ye,je,me,Se,fe,ge,Ae,_e,Re,Ee=a(9),Te=a(6),ve=function(){function e(t){Object(o.a)(this,e),this.gl=void 0,this.promises=[],this.atlases=new Map,this.textures=new Map,this.done=0,this.listeners=[],this.fonts=new Map,this.gl=t}return Object(Te.a)(e,[{key:"addListener",value:function(e){this.listeners.push(e)}}]),Object(Te.a)(e,[{key:"reportDone",value:function(){this.done++;var e,t=Object(Ee.a)(this.listeners);try{for(t.s();!(e=t.n()).done;){(0,e.value)(this.done/this.getTotal()*100,this.done>=this.getTotal())}}catch(a){t.e(a)}finally{t.f()}}},{key:"loadAtlas",value:function(e){var t=this,a=Object(s.loadAtlas)(this.gl,e,{}).then((function(a){return t.atlases.set(e,a),t.reportDone(),a}));return this.promises.push(a),a}},{key:"loadFont",value:function(e){var t=this,a=Object(s.loadFont)(this.gl,e,{}).then((function(a){return t.fonts.set(e,a),t.reportDone(),a}));return this.promises.push(a),a}},{key:"getFont",value:function(e){return this.fonts.get(e)}},{key:"getAtlas",value:function(e){return this.atlases.get(e)}},{key:"loadTexture",value:function(e){var t=this,a=Object(s.loadTexture)(this.gl,e,{}).then((function(a){return t.textures.set(e,a),t.reportDone(),a}));return this.promises.push(a),a}},{key:"getTexture",value:function(e){return this.textures.get(e)}},{key:"finishLoading",value:function(){var e=Object(r.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.promises);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getDone",value:function(){return this.done}},{key:"getTotal",value:function(){return this.promises.length}}]),e}(),we=a(12),De=a(10),Ie=a(1),He=a(11),Le=a(3),Pe=a(2),Me=a(8),xe=a(7),Ce=a(4),We=(a(17),l=Object(Ie.Inject)("playerState"),h=Object(Ie.Inject)("batch"),b=Object(Ie.Inject)("whiteTex"),u=Object(Ie.Inject)("assetManager"),O=function(e){Object(Me.a)(a,e);var t=Object(xe.a)(a);function a(){var e;Object(o.a)(this,a);for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return e=t.call.apply(t,[this].concat(n)),Object(Le.a)(e,"playerState",p,Object(Pe.a)(e)),Object(Le.a)(e,"batch",d,Object(Pe.a)(e)),Object(Le.a)(e,"whiteTex",y,Object(Pe.a)(e)),Object(Le.a)(e,"assetManager",j,Object(Pe.a)(e)),e.normalBackground=void 0,e.bossBackground=void 0,e}return Object(Te.a)(a,[{key:"initialized",value:function(){this.normalBackground=this.assetManager.getTexture("./bg.jpg"),this.bossBackground=this.assetManager.getTexture("./bg_boss.jpg")}},{key:"process",value:function(){var e=this.playerState.position.y-c.CAMERA_GAP,t=e+c.WORLD_HEIGHT;this.playerState.bossKill?t+=c.BACKGROUND_HEIGHT:t+=.6*c.BACKGROUND_HEIGHT;for(var a=0;a<c.LEVEL_COUNT;a++){var i=c.BACKGROUND_START-a*c.BACKGROUND_HEIGHT;i+c.WORLD_HEIGHT<e||i>t||(a===c.LEVEL_COUNT-1?this.batch.draw(this.bossBackground,0,i,c.BACKGROUND_WIDTH,c.BACKGROUND_HEIGHT):this.batch.draw(this.normalBackground,0,i,c.BACKGROUND_WIDTH,c.BACKGROUND_HEIGHT))}}}]),a}(Ie.System),p=Object(Ce.a)(O.prototype,"playerState",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=Object(Ce.a)(O.prototype,"batch",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=Object(Ce.a)(O.prototype,"whiteTex",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=Object(Ce.a)(O.prototype,"assetManager",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O),Ge=(m=Object(Ie.Inject)("batch"),S=Object(Ie.Inject)("assetManager"),f=Object(Ie.Inject)("playerState"),g=function(e){Object(Me.a)(a,e);var t=Object(xe.a)(a);function a(){var e;Object(o.a)(this,a);for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return e=t.call.apply(t,[this].concat(n)),Object(Le.a)(e,"batch",A,Object(Pe.a)(e)),Object(Le.a)(e,"assetManager",_,Object(Pe.a)(e)),Object(Le.a)(e,"playerState",R,Object(Pe.a)(e)),e.bossAttack=void 0,e.stateTime=0,e.bossStill=void 0,e.ending=!1,e.bossDie=void 0,e.tapIcon=void 0,e.ultiScale=c.MIN_POWER,e.ultiEffect=void 0,e.drawSize=new s.Vector2(0,0),e}return Object(Te.a)(a,[{key:"initialized",value:function(){var e=this.assetManager.getAtlas("./enemy.atlas");this.bossAttack=Object(s.createAnimation)(c.BOSS_ATTACK_RATE/9,e.findRegions("boss_attack")),this.bossDie=Object(s.createAnimation)(.2,e.findRegions("boss_die")),this.bossStill=e.findRegion("boss_attack",1),this.tapIcon=Object(s.createAnimation)(.1,e.findRegions("tap_icon"));var t=this.assetManager.getAtlas("./main.atlas");this.ultiEffect=Object(s.createAnimation)(.1,t.findRegions("ulti_effect"))}},{key:"process",value:function(){var e,t,a=600,i=this.batch,n=this.playerState,r=this.bossAttack,o=this.bossStill;if((!this.ending&&n.bossEnd&&(this.stateTime=0,this.ending=!0),n.position.y<=c.BOSS_Y+c.WORLD_HEIGHT)&&(this.ending?(this.stateTime+=this.world.delta,e=this.bossDie.getKeyFrame(this.stateTime,s.PlayMode.NORMAL),t=this.tapIcon.getKeyFrame(this.stateTime,s.PlayMode.LOOP)):n.encounterBoss?(this.stateTime+=this.world.delta,e=r.getKeyFrame(this.stateTime,s.PlayMode.LOOP)):e=o,this.playerState.bossEnd&&!this.playerState.bossKill&&(this.drawSize.set(c.PLAYER_DRAW_WIDTH/180*290,c.PLAYER_DRAW_HEIGHT/180*259),this.ultiScale=this.ultiScale+.1*(this.playerState.power-this.ultiScale),this.ultiEffect.getKeyFrame(this.playerState.animationStateTime,s.PlayMode.LOOP).draw(this.batch,this.playerState.position.x-this.drawSize.x/2,this.playerState.position.y-this.drawSize.y/2+30,this.drawSize.x,this.drawSize.y,this.drawSize.x/2,this.drawSize.y/2,0,this.ultiScale,this.ultiScale)),e.draw(i,c.BOSS_X-300,c.BOSS_Y-300,a,a),t&&!n.bossKill)){var l=9960/68;t.draw(i,c.BOSS_X-l/2+30,c.BOSS_Y-60+150,l,120)}}}]),a}(Ie.System),A=Object(Ce.a)(g.prototype,"batch",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=Object(Ce.a)(g.prototype,"assetManager",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=Object(Ce.a)(g.prototype,"playerState",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g),Ne=(E=Object(Ie.Inject)("camera"),T=Object(Ie.Inject)("playerState"),v=function(e){Object(Me.a)(a,e);var t=Object(xe.a)(a);function a(){var e;Object(o.a)(this,a);for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return e=t.call.apply(t,[this].concat(n)),Object(Le.a)(e,"camera",w,Object(Pe.a)(e)),Object(Le.a)(e,"playerState",D,Object(Pe.a)(e)),e}return Object(Te.a)(a,[{key:"process",value:function(){if(!this.playerState.bossKill){var e=this.camera.getPosition();e.set(e.x,this.playerState.position.y-c.CAMERA_GAP),this.camera.setPosition(e.x,e.y)}}}]),a}(Ie.System),w=Object(Ce.a)(v.prototype,"camera",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=Object(Ce.a)(v.prototype,"playerState",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v),ke=(I=Object(Ie.Inject)("effects"),H=Object(Ie.Inject)("camera"),L=Object(Ie.Inject)("batch"),P=Object(Ie.Inject)("assetManager"),M=function(e){Object(Me.a)(a,e);var t=Object(xe.a)(a);function a(){var e;Object(o.a)(this,a);for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return e=t.call.apply(t,[this].concat(n)),Object(Le.a)(e,"effects",x,Object(Pe.a)(e)),Object(Le.a)(e,"camera",C,Object(Pe.a)(e)),Object(Le.a)(e,"batch",W,Object(Pe.a)(e)),Object(Le.a)(e,"assetManager",G,Object(Pe.a)(e)),e.dashFxAnimation=void 0,e.text=void 0,e}return Object(Te.a)(a,[{key:"initialized",value:function(){var e=this.assetManager.getAtlas("./main.atlas").findRegions("dash_effect");this.dashFxAnimation=Object(s.createAnimation)(c.DASH_SMOKE_DURATION/4,e);var t=this.assetManager.getFont("./score.fnt");this.text=t.createRenderer(100),this.text.setAlignMode(s.AlignMode.center)}},{key:"process",value:function(){for(var e=this.effects,t=e.length-1;t>=0;t--){var a=e[t];a.elapsed+=this.world.delta,a.elapsed>=a.duration&&e.splice(t,1)}var i,n=Object(Ee.a)(e);try{for(n.s();!(i=n.n()).done;){var r=i.value;if("dash_smoke"===r.type){var o=1-r.elapsed/r.duration;this.dashFxAnimation.getKeyFrame(r.elapsed,s.PlayMode.NORMAL).draw(this.batch,r.position.x-r.size.x/2,r.position.y-r.size.y/2,r.size.x,r.size.y,r.size.x/2,r.size.y/2,0,r.flip?-o:o,o)}}}catch(c){n.e(c)}finally{n.f()}}}]),a}(Ie.System),x=Object(Ce.a)(M.prototype,"effects",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=Object(Ce.a)(M.prototype,"camera",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W=Object(Ce.a)(M.prototype,"batch",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G=Object(Ce.a)(M.prototype,"assetManager",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M),Ke=(N=Object(Ie.Inject)("viewport"),k=Object(Ie.Inject)("playerState"),K=function(e){Object(Me.a)(a,e);var t=Object(xe.a)(a);function a(){var e;Object(o.a)(this,a);for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return e=t.call.apply(t,[this].concat(n)),Object(Le.a)(e,"viewport",B,Object(Pe.a)(e)),Object(Le.a)(e,"playerState",Y,Object(Pe.a)(e)),e.inputHandler=void 0,e.holding=!1,e}return Object(Te.a)(a,[{key:"initialized",value:function(){this.inputHandler=Object(s.createViewportAwareInputHandler)(this.viewport.getCanvas(),this.viewport)}},{key:"process",value:function(){var e=this.playerState,t=this.inputHandler;if(e.dashing||e.bossEnd)e.bossEnd&&(this.holding?t.isTouched()||(this.holding=!1):t.isTouched()&&(this.holding=!0,e.power+=c.POWER_INC));else if(t.isTouched()){var a=t.getTouchedWorldCoord().x<c.WORLD_WIDTH/2,i=e.position.x<c.WORLD_WIDTH/2;a&&!i?(e.dashing=!0,e.targetX=0,e.animationStateTime=0):!a&&i?(e.dashing=!0,e.targetX=1,e.animationStateTime=0):(e.dashing=!0,e.targetX=-1,e.animationStateTime=0)}}},{key:"dispose",value:function(){this.inputHandler.cleanup()}}]),a}(Ie.System),B=Object(Ce.a)(K.prototype,"viewport",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y=Object(Ce.a)(K.prototype,"playerState",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K),Be=new(a(31).EventEmitter),Ye=(z=Object(Ie.Inject)("playerState"),U=Object(Ie.Inject)("minions"),F=Object(Ie.Inject)("effects"),X=function(e){Object(Me.a)(a,e);var t=Object(xe.a)(a);function a(){var e;Object(o.a)(this,a);for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return e=t.call.apply(t,[this].concat(n)),Object(Le.a)(e,"playerState",V,Object(Pe.a)(e)),Object(Le.a)(e,"minions",J,Object(Pe.a)(e)),Object(Le.a)(e,"effects",Z,Object(Pe.a)(e)),e}return Object(Te.a)(a,[{key:"process",value:function(){var e,t=this.minions,a=this.playerState,i=this.effects,n=Object(Ee.a)(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;if(!r.dead)a.position.distance(r.position)<=c.ENEMY_RADIUS&&a.dashing&&r.type<=1&&(r.dead=!0,r.animationStateTime=0,a.score+=100,Be.emit("score",a.score),i.push({type:"score",duration:1,elapsed:0,flip:!1,position:new s.Vector2(r.position.x,r.position.y),size:new s.Vector2(100,50)}))}}catch(b){n.e(b)}finally{n.f()}var o,l=Object(Ee.a)(t);try{for(l.s();!(o=l.n()).done;){var h=o.value;if(!h.dead)a.position.distance(h.position)<=.4*c.ENEMY_RADIUS&&(h.type>=3&&(h.dead=!0),a.knockBackDuration=c.KNOCKBACK_DURATION,a.life-=1,Be.emit("life",a.life),a.life<=0&&Be.emit("gameOver"))}}catch(b){l.e(b)}finally{l.f()}}}]),a}(Ie.System),V=Object(Ce.a)(X.prototype,"playerState",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J=Object(Ce.a)(X.prototype,"minions",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z=Object(Ce.a)(X.prototype,"effects",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),X),ze=(q=Object(Ie.Inject)("batch"),Q=Object(Ie.Inject)("assetManager"),$=Object(Ie.Inject)("minions"),ee=Object(Ie.Inject)("playerState"),te=function(e){Object(Me.a)(a,e);var t=Object(xe.a)(a);function a(e){var i;return Object(o.a)(this,a),i=t.call(this),Object(Le.a)(i,"batch",ae,Object(Pe.a)(i)),Object(Le.a)(i,"assetManager",ie,Object(Pe.a)(i)),Object(Le.a)(i,"minions",ne,Object(Pe.a)(i)),Object(Le.a)(i,"playerState",re,Object(Pe.a)(i)),i.runAnimations=void 0,i.deadAnimations=void 0,i.projectileAnimations=void 0,i.front=void 0,i.rockRegion=void 0,i.drawSize=new s.Vector2(0,0),i.front=e,i}return Object(Te.a)(a,[{key:"initialized",value:function(){var e=this.assetManager.getAtlas("./enemy.atlas"),t=Object(s.createAnimation)(.1,e.findRegions("blue_minion_run")),a=Object(s.createAnimation)(.1,e.findRegions("red_minion_run")),i=Object(s.createAnimation)(.1,e.findRegions("blue_minion_die")),n=Object(s.createAnimation)(.1,e.findRegions("red_minion_die")),r=Object(s.createAnimation)(.1,e.findRegions("boss_projectile_A")),o=Object(s.createAnimation)(.15,e.findRegions("boss_projectile_B"));this.runAnimations=[t,a],this.deadAnimations=[i,n],this.projectileAnimations=[r,o],this.rockRegion=e.findRegion("rock",-1)}},{key:"process",value:function(){var e,t=this.batch,a=this.minions,i=this.runAnimations,n=this.deadAnimations,r=this.playerState,o=this.drawSize,l=this.projectileAnimations,h=Object(Ee.a)(a);try{for(h.s();!(e=h.n()).done;){var b=e.value;if(b.dead){if(this.front)continue}else{if(!this.front&&b.position.y>r.position.y-c.PLAYER_HEIGHT/4)continue;if(this.front&&b.position.y<=r.position.y-c.PLAYER_HEIGHT/4)continue}b.animationStateTime+=this.world.delta;var u=void 0;2===b.type?(u=this.rockRegion,o.set(115*c.ROCK_RADIUS/105,c.ROCK_RADIUS).scale(2)):b.type<=1?(o.set(c.ENEMY_RADIUS,c.ENEMY_RADIUS).scale(2),u=b.dead?n[b.type].getKeyFrame(b.animationStateTime,s.PlayMode.NORMAL):i[b.type].getKeyFrame(b.animationStateTime,s.PlayMode.LOOP)):3===b.type?(o.set(120*c.ENEMY_RADIUS/154,c.ENEMY_RADIUS).scale(1.5),u=l[0].getKeyFrame(b.animationStateTime,s.PlayMode.LOOP)):(o.set(144*c.ENEMY_RADIUS/196,c.ENEMY_RADIUS).scale(2),u=l[1].getKeyFrame(b.animationStateTime,s.PlayMode.NORMAL)),u&&u.draw(t,b.position.x-o.x/2,b.position.y-o.y/2,o.x,o.y)}}catch(O){h.e(O)}finally{h.f()}}}]),a}(Ie.System),ae=Object(Ce.a)(te.prototype,"batch",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ie=Object(Ce.a)(te.prototype,"assetManager",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ne=Object(Ce.a)(te.prototype,"minions",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),re=Object(Ce.a)(te.prototype,"playerState",[ee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),te),Ue=(se=Object(Ie.Inject)("playerState"),oe=Object(Ie.Inject)("minions"),ce=function(e){Object(Me.a)(a,e);var t=Object(xe.a)(a);function a(){var e;Object(o.a)(this,a);for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return e=t.call.apply(t,[this].concat(n)),Object(Le.a)(e,"playerState",le,Object(Pe.a)(e)),Object(Le.a)(e,"minions",he,Object(Pe.a)(e)),e.generatedY=3*-c.BACKGROUND_HEIGHT,e.accumulate=0,e.generatedProjectiles=0,e}return Object(Te.a)(a,[{key:"generateBossProjectiles",value:function(){var e=this.minions,t=this.playerState;t.bossEnd||(this.accumulate+=this.world.delta,this.accumulate>=c.BOSS_ATTACK_RATE&&(this.accumulate=0,e.push({type:Math.random()>.5?3:4,animationStateTime:0,dead:!1,position:new s.Vector2(Math.random()>.5?c.PLAYER_X_TARGETS[0]:c.PLAYER_X_TARGETS[1],c.BOSS_Y+100)}),this.generatedProjectiles+=1,this.generatedProjectiles>=c.BOSS_PROJECTILE_COUNT&&(t.bossEnd=!0,t.animationStateTime=0)))}},{key:"process",value:function(){var e=this.playerState,t=this.minions;for(e.encounterBoss&&this.generateBossProjectiles();e.position.y<this.generatedY+3*c.BACKGROUND_HEIGHT&&this.generatedY>=-c.BACKGROUND_HEIGHT*(c.LEVEL_COUNT-6);){for(var a=0;a<10;a++)if(Math.random()<.3){var i={animationStateTime:0,dead:!1,type:Math.random()>=.3?Math.random()>.5?0:1:2,position:new s.Vector2(Math.random()>.5?c.PLAYER_X_TARGETS[0]:c.PLAYER_X_TARGETS[1],this.generatedY-3*c.BACKGROUND_HEIGHT/10*a)};t.push(i)}this.generatedY-=3*c.BACKGROUND_HEIGHT}for(var n=t.length-1;n>=0;n--){var r=t[n];!r.dead&&r.type<=1?r.position.set(r.position.x,r.position.y+c.ENEMY_SPEED_Y*this.world.delta):!r.dead&&r.type>=3&&r.position.set(r.position.x,r.position.y+10*c.ENEMY_SPEED_Y*this.world.delta),(r.position.y>e.position.y+2*c.BACKGROUND_HEIGHT||r.type>=3&&r.dead)&&t.splice(n,1)}}}]),a}(Ie.System),le=Object(Ce.a)(ce.prototype,"playerState",[se],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),he=Object(Ce.a)(ce.prototype,"minions",[oe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ce),Fe=(be=Object(Ie.Inject)("playerState"),ue=function(e){Object(Me.a)(a,e);var t=Object(xe.a)(a);function a(){var e;Object(o.a)(this,a);for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return e=t.call.apply(t,[this].concat(n)),Object(Le.a)(e,"playerState",Oe,Object(Pe.a)(e)),e.tmpVector=new s.Vector2(0,0),e.done=!1,e.accumulate=0,e}return Object(Te.a)(a,[{key:"process",value:function(){var e=this.playerState.position,t=this.playerState.velocity,a=c.BACKGROUND_START-(c.LEVEL_COUNT-1)*c.BACKGROUND_HEIGHT+c.CAMERA_GAP;if(this.playerState.knockBackDuration>0?(this.playerState.knockBackDuration-=this.world.delta,e.y>a&&t.set(t.x,c.PLAYER_KNOCKBACK_FORCE)):(this.playerState.knockBackDuration=0,e.y>a?t.set(t.x,c.PLAYER_SPEED_Y):this.playerState.bossKill||(t.set(t.x,0),e.set(e.x,a),this.playerState.encounterBoss=!0)),this.playerState.bossEnd){this.processPowerDecay(),this.playerState.dashing=!1;var i=e.x+.1*(c.WORLD_WIDTH/2-e.x);if(e.set(i,e.y),this.playerState.bossKill){var n=e.y+.1*(c.BOSS_Y+200-e.y);e.set(e.x,n)}t.set(0,0)}if(this.playerState.dashing){var r=this.playerState.targetX;0===r?e.x>c.PLAYER_X_TARGETS[0]?t.set(-c.PLAYER_DASH_SPEED,t.y):(t.set(0,t.y),e.set(c.PLAYER_X_TARGETS[0],e.y),this.playerState.dashing=!1):1===r?e.x<c.PLAYER_X_TARGETS[1]?t.set(c.PLAYER_DASH_SPEED,t.y):(t.set(0,t.y),e.set(c.PLAYER_X_TARGETS[1],e.y),this.playerState.dashing=!1):this.playerState.animationStateTime>=.5&&(this.playerState.dashing=!1,this.playerState.animationStateTime=0)}!this.done&&e.y-c.BOSS_Y<=250&&(this.playerState.score+=1e3,this.done=!0,Be.emit("gameOver")),this.tmpVector.setVector(t).scale(this.world.delta),e.addVector(this.tmpVector)}},{key:"processPowerDecay",value:function(){if(this.accumulate+=this.world.delta,!this.playerState.bossKill){for(;this.accumulate>=c.POWER_DEC_RATE;)this.playerState.power-=c.POWER_DEC,this.accumulate-=c.POWER_DEC_RATE;this.playerState.power=Math.max(c.MIN_POWER,this.playerState.power),this.playerState.power=Math.min(c.MAX_POWER,this.playerState.power),this.playerState.power===c.MAX_POWER&&(this.playerState.bossKill=!0,this.playerState.animationStateTime=0)}}}]),a}(Ie.System),Oe=Object(Ce.a)(ue.prototype,"playerState",[be],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ue),Xe=(pe=Object(Ie.Inject)("playerState"),de=Object(Ie.Inject)("batch"),ye=Object(Ie.Inject)("whiteTex"),je=Object(Ie.Inject)("assetManager"),me=Object(Ie.Inject)("effects"),Se=function(e){Object(Me.a)(a,e);var t=Object(xe.a)(a);function a(){var e;Object(o.a)(this,a);for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return e=t.call.apply(t,[this].concat(n)),Object(Le.a)(e,"playerState",fe,Object(Pe.a)(e)),Object(Le.a)(e,"batch",ge,Object(Pe.a)(e)),Object(Le.a)(e,"whiteTex",Ae,Object(Pe.a)(e)),Object(Le.a)(e,"assetManager",_e,Object(Pe.a)(e)),Object(Le.a)(e,"effects",Re,Object(Pe.a)(e)),e.runAnimation=void 0,e.idleAnimation=void 0,e.dashAnimation=void 0,e.ultiAnimation=void 0,e.channelingAnimation=void 0,e.killingAnimation=void 0,e.drawSize=new s.Vector2(0,0),e.ultiScale=c.MIN_POWER,e.frame=0,e}return Object(Te.a)(a,[{key:"initialized",value:function(){var e=this.assetManager.getAtlas("./main.atlas"),t=e.findRegions("mina_run"),a=t.filter((function(e,t){return[3,4].includes(t)})),i=e.findRegions("mina_dash"),n=e.findRegions("mina_ulti");this.runAnimation=Object(s.createAnimation)(.1,t),this.idleAnimation=Object(s.createAnimation)(.5,a),this.dashAnimation=Object(s.createAnimation)(.05,i),this.ultiAnimation=Object(s.createAnimation)(.1,n.slice(0,7)),this.channelingAnimation=Object(s.createAnimation)(.1,n.slice(3,7)),this.killingAnimation=Object(s.createAnimation)(.04,n.slice(3,11))}},{key:"process",value:function(){var e;this.playerState.animationStateTime+=this.world.delta,this.frame++;var t=!1;this.playerState.bossKill?(this.drawSize.set(c.PLAYER_DRAW_WIDTH/180*290,c.PLAYER_DRAW_HEIGHT/180*259),e=this.killingAnimation.getKeyFrame(this.playerState.animationStateTime,s.PlayMode.NORMAL)):this.playerState.bossEnd?(e=this.playerState.animationStateTime<=.8?this.ultiAnimation.getKeyFrame(this.playerState.animationStateTime,s.PlayMode.NORMAL):this.channelingAnimation.getKeyFrame(this.playerState.animationStateTime,s.PlayMode.LOOP),this.drawSize.set(c.PLAYER_DRAW_WIDTH/180*290,c.PLAYER_DRAW_HEIGHT/180*259)):this.playerState.dashing?(this.drawSize.set(295/180*c.PLAYER_DRAW_WIDTH,c.PLAYER_DRAW_HEIGHT),e=this.dashAnimation.getKeyFrame(this.playerState.animationStateTime,s.PlayMode.NORMAL),1===this.playerState.targetX&&(t=!0),this.frame%4===0&&this.effects.push({type:"dash_smoke",position:new s.Vector2(this.playerState.position.x,this.playerState.position.y),duration:c.DASH_SMOKE_DURATION,elapsed:0,flip:1===this.playerState.targetX,size:new s.Vector2(c.DASH_SMOKE_SIZE,c.DASH_SMOKE_SIZE)})):(this.drawSize.set(c.PLAYER_DRAW_WIDTH,c.PLAYER_DRAW_HEIGHT),e=this.playerState.velocity.y<0?this.runAnimation.getKeyFrame(this.playerState.animationStateTime,s.PlayMode.LOOP):this.idleAnimation.getKeyFrame(this.playerState.animationStateTime,s.PlayMode.LOOP)),this.playerState.knockBackDuration>0&&this.batch.setColor(1,1,1,1-this.playerState.knockBackDuration/c.KNOCKBACK_DURATION),e.draw(this.batch,this.playerState.position.x-this.drawSize.x/2,this.playerState.position.y-this.drawSize.y/2,this.drawSize.x,this.drawSize.y,this.drawSize.x/2,this.drawSize.y/2,0,t?-1:1),this.batch.setColor(1,1,1,1)}}]),a}(Ie.System),fe=Object(Ce.a)(Se.prototype,"playerState",[pe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ge=Object(Ce.a)(Se.prototype,"batch",[de],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ae=Object(Ce.a)(Se.prototype,"whiteTex",[ye],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_e=Object(Ce.a)(Se.prototype,"assetManager",[je],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Re=Object(Ce.a)(Se.prototype,"effects",[me],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Se),Ve=a(19),Je=a(15);function Ze(e,t,a,i,n,r,o){var l=new Ie.World,h={position:new s.Vector2(c.PLAYER_X_TARGETS[0],0),velocity:new s.Vector2(0,0),animationStateTime:0,encounterBoss:!1,targetX:c.PLAYER_X_TARGETS[0],dashing:!1,knockBackDuration:0,life:3,bossEnd:!1,power:0,bossKill:!1,score:0},b=o.getAtlas("./ui.atlas"),u=new He.Stage(t),O=b.findRegion("avatar",-1),p=b.findRegion("heart_full",-1),d=b.findRegion("heart_empty",-1),y=b.findRegion("score_label",-1),j=b.findRegion("gameOver",-1),m=b.findRegion("retry_btn",-1),S=o.getFont("./score.fnt"),f=o.getFont("./score_result.fnt"),g=!1,A=function(){var e=Object(Je.useState)(3),t=Object(De.a)(e,2),a=t[0],i=t[1],n=Object(Je.useState)(0),r=Object(De.a)(n,2),s=r[0],o=r[1];return Object(Je.useEffect)((function(){return Be.on("life",i),Be.on("score",o),function(){Be.off("life",i),Be.off("score",o)}}),[]),Object(we.jsxs)(He.RActor,{style:{flex:1,paddingTop:15,paddingRight:15,alignItems:Ve.ALIGN_FLEX_END},children:[Object(we.jsxs)(He.RActor,{style:{flexDirection:"row"},children:[Object(we.jsxs)(He.RActor,{style:{flexDirection:"column",alignItems:Ve.ALIGN_FLEX_END},children:[Object(we.jsx)(He.RImage,{region:y,style:{height:40,width:40/17*63}}),Object(we.jsx)(He.RLabel,{font:S,text:s.toString(),align:He.LabelAlign.right,style:{height:40,width:200}})]}),Object(we.jsx)(He.RImage,{style:{width:100,height:100,marginLeft:10},region:O})]}),Object(we.jsx)(He.RActor,{style:{flex:1,paddingTop:10,flexDirection:"row"},children:[2,1,0].map((function(e){return Object(we.jsx)(He.RImage,{region:e<a?p:d,style:{width:40,height:40,marginLeft:5}},e)}))})]})},_=function(){var s=Object(Je.useState)(!1),l=Object(De.a)(s,2),b=l[0],u=l[1];return Object(Je.useEffect)((function(){Be.once("gameOver",(function(){g=!0,u(!0)}))}),[]),b?Object(we.jsx)(He.RActor,{style:{flex:1,justifyContent:Ve.JUSTIFY_FLEX_END,alignItems:Ve.ALIGN_CENTER},children:Object(we.jsxs)(He.RImage,{region:j,style:{width:c.WORLD_WIDTH,height:450*c.WORLD_WIDTH/300,alignItems:Ve.ALIGN_CENTER},children:[Object(we.jsx)(He.RLabel,{font:f,text:h.score.toString(),align:He.LabelAlign.center,style:{marginTop:180,width:c.WORLD_WIDTH,height:90}}),Object(we.jsx)(He.RImageButton,{upRegion:m,downRegion:m,style:{marginTop:20,height:30,width:242},onTouchEnd:function(){console.log("retry"),e.setScreen(Ze(e,t,a,i,n,r,o))}})]})}):Object(we.jsx)(A,{})};He.ReactGdxjsStageRenderer.render(Object(we.jsx)(_,{}),new He.StageWrapper(u));return l.register("playerState",h),l.register("camera",a),l.register("batch",n),l.register("whiteTex",r),l.register("assetManager",o),l.register("viewport",t),l.register("effects",[]),l.register("minions",[]),l.addSystem(new Ke),l.addSystem(new Fe),l.addSystem(new Ue),l.addSystem(new Ye),l.addSystem(new Ne),l.addSystem(new We,!1),l.addSystem(new ke,!1),l.addSystem(new Ge,!1),l.addSystem(new ze(!1),!1),l.addSystem(new Xe,!1),l.addSystem(new ze(!0),!1),{dispose:function(){u.dispose(),l.dispose()},update:function(e){n.setProjection(i.combined),n.begin(),n.setColor(0,0,0,1),Object(s.fillRect)(n,r,0,0,c.WORLD_WIDTH,c.WORLD_HEIGHT),n.setColor(1,1,1,1),n.end(),n.setProjection(a.combined),n.begin(),l.setDelta(e),g?l.setDelta(0):l.processActiveSystem(),l.processPassiveSystem(),n.end(),g&&(n.setProjection(i.combined),n.begin(),n.setColor(0,0,0,.75),Object(s.fillRect)(n,r,0,0,c.WORLD_WIDTH,c.WORLD_HEIGHT),n.setColor(1,1,1,1),n.end()),u.act(e),u.draw()}}}(function(){var e=Object(r.a)(n.a.mark((function e(){var t,a,i,r,o,l,h,b,u,O;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object(s.createStage)(),a=t.getCanvas(),i=Object(s.createViewport)(a,c.WORLD_WIDTH,c.WORLD_HEIGHT,{crop:!1,autoUpdate:!0,pixelRatio:1}),r=Object(s.createOrthoCamera)(c.WORLD_WIDTH,c.WORLD_HEIGHT,a.width,a.height),i.addCamera(r),i.update(),o=i.getCamera(),l=i.getContext(),h=Object(s.createBatch)(l),b=Object(s.createWhiteTexture)(l),(u=new ve(l)).loadTexture("./bg_boss.jpg"),u.loadTexture("./bg.jpg"),u.loadAtlas("./main.atlas"),u.loadAtlas("./enemy.atlas"),u.loadAtlas("./ui.atlas"),u.loadFont("./score.fnt"),u.loadFont("./score_result.fnt"),e.next=20,u.finishLoading();case 20:(O=new s.Game).setScreen(Ze(O,i,o,r,h,b,u)),l.clearColor(.2,.2,.2,1),Object(s.createGameLoop)((function(e){l.clear(l.COLOR_BUFFER_BIT),O.update(e,null)}));case 24:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()},80:function(e,t,a){}},[[116,1,2]]]);