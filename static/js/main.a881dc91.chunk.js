(this["webpackJsonplienquan-mina"]=this["webpackJsonplienquan-mina"]||[]).push([[0],{117:function(e,t,a){"use strict";a.r(t);var i=a(13),n=a.n(i),r=a(19),s=a(0),o=(a(81),a(5)),c=function e(){Object(o.a)(this,e)};c.WORLD_WIDTH=500,c.WORLD_HEIGHT=1e3,c.PLAYER_WIDTH=150,c.PLAYER_HEIGHT=150,c.PLAYER_DRAW_WIDTH=2*c.PLAYER_WIDTH,c.PLAYER_DRAW_HEIGHT=2*c.PLAYER_HEIGHT,c.PLAYER_SPEED_Y=-400,c.PLAYER_DASH_SPEED=600,c.PLAYER_KNOCKBACK_FORCE=800,c.PLAYER_X_TARGETS=[.25*c.WORLD_WIDTH,.75*c.WORLD_WIDTH],c.BACKGROUND_START=-(c.WORLD_HEIGHT-(c.CAMERA_GAP=.8*c.WORLD_HEIGHT)),c.BACKGROUND_ASPECT_RATIO=.6,c.BACKGROUND_HEIGHT=(c.BACKGROUND_WIDTH=c.WORLD_WIDTH)/c.BACKGROUND_ASPECT_RATIO,c.LEVEL_COUNT=30,c.DASH_SMOKE_SIZE=120,c.DASH_SMOKE_DURATION=.4,c.ENEMY_RADIUS=150,c.ENEMY_SPEED_Y=100,c.ROCK_RADIUS=100,c.BOSS_X=c.WORLD_WIDTH/2,c.BOSS_Y=c.BACKGROUND_START-(c.LEVEL_COUNT-1)*c.BACKGROUND_HEIGHT+160,c.BOSS_ATTACK_RATE=.8,c.BOSS_PROJECTILE_COUNT=20,c.MIN_POWER=.5,c.MAX_POWER=3,c.POWER_INC=.25,c.POWER_DEC=.1,c.POWER_DEC_RATE=.1,c.KNOCKBACK_DURATION=.2;var l,h,b,u,d,p,O,y,j,m,g,f,S,_,A,R,E,T,w,v,D,I,L,P,H,x,C,M,k,N,G,W,K,Y,z,B,U,F,V,X,J,Z,q,Q,$,ee,te,ae,ie,ne,re,se,oe,ce,le,he,be,ue,de,pe,Oe,ye,je,me,ge,fe,Se,_e,Ae,Re,Ee=a(12),Te=a(6),we=function(){function e(t){Object(o.a)(this,e),this.gl=void 0,this.promises=[],this.atlases=new Map,this.textures=new Map,this.done=0,this.listeners=[],this.fonts=new Map,this.gl=t}return Object(Te.a)(e,[{key:"addListener",value:function(e){this.listeners.push(e)}}]),Object(Te.a)(e,[{key:"reportDone",value:function(){this.done++;var e,t=Object(Ee.a)(this.listeners);try{for(t.s();!(e=t.n()).done;){(0,e.value)(this.done/this.getTotal()*100,this.done>=this.getTotal())}}catch(a){t.e(a)}finally{t.f()}}},{key:"loadAtlas",value:function(e){var t=this,a=Object(s.loadAtlas)(this.gl,e,{}).then((function(a){return t.atlases.set(e,a),t.reportDone(),a}));return this.promises.push(a),a}},{key:"loadFont",value:function(e){var t=this,a=Object(s.loadFont)(this.gl,e,{}).then((function(a){return t.fonts.set(e,a),t.reportDone(),a}));return this.promises.push(a),a}},{key:"getFont",value:function(e){return this.fonts.get(e)}},{key:"getAtlas",value:function(e){return this.atlases.get(e)}},{key:"loadTexture",value:function(e){var t=this,a=Object(s.loadTexture)(this.gl,e,{}).then((function(a){return t.textures.set(e,a),t.reportDone(),a}));return this.promises.push(a),a}},{key:"getTexture",value:function(e){return this.textures.get(e)}},{key:"finishLoading",value:function(){var e=Object(r.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.promises);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getDone",value:function(){return this.done}},{key:"getTotal",value:function(){return this.promises.length}}]),e}(),ve=a(8),De=a(11),Ie=a(7),Le=a(16),Pe=a(15),He=a(1),xe=a(3),Ce=a(2),Me=a(10),ke=a(9),Ne=a(4),Ge=(a(18),l=Object(He.Inject)("playerState"),h=Object(He.Inject)("batch"),b=Object(He.Inject)("whiteTex"),u=Object(He.Inject)("assetManager"),d=function(e){Object(Me.a)(a,e);var t=Object(ke.a)(a);function a(){var e;Object(o.a)(this,a);for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return e=t.call.apply(t,[this].concat(n)),Object(xe.a)(e,"playerState",p,Object(Ce.a)(e)),Object(xe.a)(e,"batch",O,Object(Ce.a)(e)),Object(xe.a)(e,"whiteTex",y,Object(Ce.a)(e)),Object(xe.a)(e,"assetManager",j,Object(Ce.a)(e)),e.backgrounds=[],e}return Object(Te.a)(a,[{key:"initialized",value:function(){for(var e=0;e<8;e++)this.backgrounds.push(this.assetManager.getTexture("./background/bg_0".concat(e+1,".jpg")))}},{key:"process",value:function(){var e=this.playerState.position.y-c.CAMERA_GAP,t=e+c.WORLD_HEIGHT;this.playerState.bossKill?t+=c.BACKGROUND_HEIGHT:t+=.6*c.BACKGROUND_HEIGHT;for(var a=0;a<c.LEVEL_COUNT;a++){var i=c.BACKGROUND_START-a*c.BACKGROUND_HEIGHT;if(!(i+2*c.BACKGROUND_HEIGHT<e||i>t)){var n=void 0,r=1;a===c.LEVEL_COUNT-1?n=this.backgrounds[7]:a>=c.LEVEL_COUNT-10&&a%2===0?(n=this.backgrounds[6],r=2):a===c.LEVEL_COUNT-12?(n=this.backgrounds[5],r=2):a>=c.LEVEL_COUNT-14&&a%2===0?(n=this.backgrounds[4],r=2):a===c.LEVEL_COUNT-16?(n=this.backgrounds[3],r=2):a>=c.LEVEL_COUNT-18&&a%2===0?(n=this.backgrounds[2],r=2):a===c.LEVEL_COUNT-20?(n=this.backgrounds[1],r=2):a<=c.LEVEL_COUNT-22&&(n=this.backgrounds[0]),n&&this.batch.draw(n,0,i,c.BACKGROUND_WIDTH,c.BACKGROUND_HEIGHT*r)}}}}]),a}(He.System),p=Object(Ne.a)(d.prototype,"playerState",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=Object(Ne.a)(d.prototype,"batch",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=Object(Ne.a)(d.prototype,"whiteTex",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=Object(Ne.a)(d.prototype,"assetManager",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d),We=(m=Object(He.Inject)("batch"),g=Object(He.Inject)("assetManager"),f=Object(He.Inject)("playerState"),S=function(e){Object(Me.a)(a,e);var t=Object(ke.a)(a);function a(){var e;Object(o.a)(this,a);for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return e=t.call.apply(t,[this].concat(n)),Object(xe.a)(e,"batch",_,Object(Ce.a)(e)),Object(xe.a)(e,"assetManager",A,Object(Ce.a)(e)),Object(xe.a)(e,"playerState",R,Object(Ce.a)(e)),e.bossAttack=void 0,e.stateTime=0,e.bossStill=void 0,e.ending=!1,e.bossDie=void 0,e.tapIcon=void 0,e.ultiScale=c.MIN_POWER,e.ultiEffect=void 0,e.drawSize=new s.Vector2(0,0),e}return Object(Te.a)(a,[{key:"initialized",value:function(){var e=this.assetManager.getAtlas("./enemy.atlas");this.bossAttack=Object(s.createAnimation)(c.BOSS_ATTACK_RATE/9,e.findRegions("boss_attack")),this.bossDie=Object(s.createAnimation)(.2,e.findRegions("boss_die")),this.bossStill=e.findRegion("boss_attack",1),this.tapIcon=Object(s.createAnimation)(.1,e.findRegions("tap_icon"));var t=this.assetManager.getAtlas("./main.atlas");this.ultiEffect=Object(s.createAnimation)(.1,t.findRegions("ulti_effect"))}},{key:"process",value:function(){var e,t,a=600,i=this.batch,n=this.playerState,r=this.bossAttack,o=this.bossStill;if((!this.ending&&n.bossEnd&&(this.stateTime=0,this.ending=!0),n.position.y<=c.BOSS_Y+c.WORLD_HEIGHT)&&(this.ending?(this.stateTime+=this.world.delta,e=this.bossDie.getKeyFrame(this.stateTime,s.PlayMode.NORMAL),t=this.tapIcon.getKeyFrame(this.stateTime,s.PlayMode.LOOP)):n.encounterBoss?(this.stateTime+=this.world.delta,e=r.getKeyFrame(this.stateTime,s.PlayMode.LOOP)):e=o,this.playerState.bossEnd&&!this.playerState.bossKill&&(this.drawSize.set(c.PLAYER_DRAW_WIDTH/180*290,c.PLAYER_DRAW_HEIGHT/180*259),this.ultiScale=this.ultiScale+.1*(this.playerState.power-this.ultiScale),this.ultiEffect.getKeyFrame(this.playerState.animationStateTime,s.PlayMode.LOOP).draw(this.batch,this.playerState.position.x-this.drawSize.x/2,this.playerState.position.y-this.drawSize.y/2+30,this.drawSize.x,this.drawSize.y,this.drawSize.x/2,this.drawSize.y/2,0,this.ultiScale,this.ultiScale)),e.draw(i,c.BOSS_X-300,c.BOSS_Y-300,a,a),t&&!n.bossKill)){var l=9960/68;t.draw(i,c.BOSS_X-l/2+30,c.BOSS_Y-60+150,l,120)}}}]),a}(He.System),_=Object(Ne.a)(S.prototype,"batch",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=Object(Ne.a)(S.prototype,"assetManager",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=Object(Ne.a)(S.prototype,"playerState",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S),Ke=(E=Object(He.Inject)("camera"),T=Object(He.Inject)("playerState"),w=function(e){Object(Me.a)(a,e);var t=Object(ke.a)(a);function a(){var e;Object(o.a)(this,a);for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return e=t.call.apply(t,[this].concat(n)),Object(xe.a)(e,"camera",v,Object(Ce.a)(e)),Object(xe.a)(e,"playerState",D,Object(Ce.a)(e)),e}return Object(Te.a)(a,[{key:"process",value:function(){if(!this.playerState.bossKill){var e=this.camera.getPosition();e.set(e.x,this.playerState.position.y-c.CAMERA_GAP),this.camera.setPosition(e.x,e.y)}}}]),a}(He.System),v=Object(Ne.a)(w.prototype,"camera",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=Object(Ne.a)(w.prototype,"playerState",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w),Ye=(I=Object(He.Inject)("effects"),L=Object(He.Inject)("camera"),P=Object(He.Inject)("batch"),H=Object(He.Inject)("assetManager"),x=function(e){Object(Me.a)(a,e);var t=Object(ke.a)(a);function a(){var e;Object(o.a)(this,a);for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return e=t.call.apply(t,[this].concat(n)),Object(xe.a)(e,"effects",C,Object(Ce.a)(e)),Object(xe.a)(e,"camera",M,Object(Ce.a)(e)),Object(xe.a)(e,"batch",k,Object(Ce.a)(e)),Object(xe.a)(e,"assetManager",N,Object(Ce.a)(e)),e.dashFxAnimation=void 0,e.text=void 0,e}return Object(Te.a)(a,[{key:"initialized",value:function(){var e=this.assetManager.getAtlas("./main.atlas").findRegions("dash_effect");this.dashFxAnimation=Object(s.createAnimation)(c.DASH_SMOKE_DURATION/4,e);var t=this.assetManager.getFont("./score.fnt");this.text=t.createRenderer(100),this.text.setAlignMode(s.AlignMode.center)}},{key:"process",value:function(){for(var e=this.effects,t=e.length-1;t>=0;t--){var a=e[t];a.elapsed+=this.world.delta,a.elapsed>=a.duration&&e.splice(t,1)}var i,n=Object(Ee.a)(e);try{for(n.s();!(i=n.n()).done;){var r=i.value;if("dash_smoke"===r.type){var o=1-r.elapsed/r.duration;this.dashFxAnimation.getKeyFrame(r.elapsed,s.PlayMode.NORMAL).draw(this.batch,r.position.x-r.size.x/2,r.position.y-r.size.y/2,r.size.x,r.size.y,r.size.x/2,r.size.y/2,0,r.flip?-o:o,o)}}}catch(c){n.e(c)}finally{n.f()}}}]),a}(He.System),C=Object(Ne.a)(x.prototype,"effects",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=Object(Ne.a)(x.prototype,"camera",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=Object(Ne.a)(x.prototype,"batch",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N=Object(Ne.a)(x.prototype,"assetManager",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x),ze=a(39),Be=new ze.Howl({src:["sprite/sprite.ogg","sprite/sprite.m4a","sprite/sprite.mp3","sprite/sprite.ac3"],sprite:{attack_01:[0,440],attack_02:[2e3,348.6167800453517],attack_03:[4e3,914.9433106575966],end:[6e3,1599.9999999999995],hit_01:[9e3,322.154195011338],hit_02:[11e3,427.6190476190482],start:[13e3,1230.8616780045352],dash:[16e3,166.5532879818592],hit:[18e3,313.4693877551023]}}),Ue=new ze.Howl({src:"mina-bg.mp3"}),Fe=function(e){return Be.play(e)},Ve=(G=Object(He.Inject)("viewport"),W=Object(He.Inject)("playerState"),K=function(e){Object(Me.a)(a,e);var t=Object(ke.a)(a);function a(){var e;Object(o.a)(this,a);for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return e=t.call.apply(t,[this].concat(n)),Object(xe.a)(e,"viewport",Y,Object(Ce.a)(e)),Object(xe.a)(e,"playerState",z,Object(Ce.a)(e)),e.inputHandler=void 0,e.holding=!1,e}return Object(Te.a)(a,[{key:"initialized",value:function(){this.inputHandler=Object(s.createViewportAwareInputHandler)(this.viewport.getCanvas(),this.viewport)}},{key:"process",value:function(){var e=this.playerState,t=this.inputHandler;if(e.dashing||e.bossEnd)e.bossEnd&&(this.holding?t.isTouched()||(this.holding=!1):t.isTouched()&&(this.holding=!0,e.power+=c.POWER_INC));else if(t.isTouched()){var a=t.getTouchedWorldCoord().x<c.WORLD_WIDTH/2,i=e.position.x<c.WORLD_WIDTH/2;a&&!i?(e.dashing=!0,e.targetX=0,e.animationStateTime=0):!a&&i?(e.dashing=!0,e.targetX=1,e.animationStateTime=0):(e.dashing=!0,e.targetX=-1,e.animationStateTime=0),Fe(Math.random()>.5?"attack_01":"attack_02")}}},{key:"dispose",value:function(){this.inputHandler.cleanup()}}]),a}(He.System),Y=Object(Ne.a)(K.prototype,"viewport",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=Object(Ne.a)(K.prototype,"playerState",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K),Xe=new(a(31).EventEmitter),Je=(B=Object(He.Inject)("playerState"),U=Object(He.Inject)("minions"),F=Object(He.Inject)("effects"),V=function(e){Object(Me.a)(a,e);var t=Object(ke.a)(a);function a(){var e;Object(o.a)(this,a);for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return e=t.call.apply(t,[this].concat(n)),Object(xe.a)(e,"playerState",X,Object(Ce.a)(e)),Object(xe.a)(e,"minions",J,Object(Ce.a)(e)),Object(xe.a)(e,"effects",Z,Object(Ce.a)(e)),e}return Object(Te.a)(a,[{key:"process",value:function(){var e,t=this.minions,a=this.playerState,i=Object(Ee.a)(t);try{for(i.s();!(e=i.n()).done;){var n=e.value;if(!n.dead)a.position.distance(n.position)<=c.ENEMY_RADIUS&&a.dashing&&n.type<=1&&(n.dead=!0,n.position.y=n.position.y-75,Fe("hit"),n.animationStateTime=0,a.score+=100,Xe.emit("score",a.score))}}catch(l){i.e(l)}finally{i.f()}var r,s=Object(Ee.a)(t);try{for(s.s();!(r=s.n()).done;){var o=r.value;if(!o.dead)a.position.distance(o.position)<=.4*c.ENEMY_RADIUS&&(o.type>=3&&(o.dead=!0),a.knockBackDuration=c.KNOCKBACK_DURATION,a.life-=1,Fe(Math.random()>.5?"hit_01":"hit_02"),Xe.emit("life",a.life),a.life<=0&&Xe.emit("gameOver"))}}catch(l){s.e(l)}finally{s.f()}}}]),a}(He.System),X=Object(Ne.a)(V.prototype,"playerState",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J=Object(Ne.a)(V.prototype,"minions",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z=Object(Ne.a)(V.prototype,"effects",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V),Ze=(q=Object(He.Inject)("batch"),Q=Object(He.Inject)("assetManager"),$=Object(He.Inject)("minions"),ee=Object(He.Inject)("playerState"),te=function(e){Object(Me.a)(a,e);var t=Object(ke.a)(a);function a(e){var i;return Object(o.a)(this,a),i=t.call(this),Object(xe.a)(i,"batch",ae,Object(Ce.a)(i)),Object(xe.a)(i,"assetManager",ie,Object(Ce.a)(i)),Object(xe.a)(i,"minions",ne,Object(Ce.a)(i)),Object(xe.a)(i,"playerState",re,Object(Ce.a)(i)),i.runAnimations=void 0,i.deadAnimations=void 0,i.projectileAnimations=void 0,i.front=void 0,i.rockRegion=void 0,i.drawSize=new s.Vector2(0,0),i.tmp=new s.Vector2(0,0),i.front=e,i}return Object(Te.a)(a,[{key:"initialized",value:function(){var e=this.assetManager.getAtlas("./enemy.atlas"),t=Object(s.createAnimation)(.1,e.findRegions("blue_minion_run")),a=Object(s.createAnimation)(.1,e.findRegions("red_minion_run")),i=Object(s.createAnimation)(.1,e.findRegions("blue_minion_die")),n=Object(s.createAnimation)(.1,e.findRegions("red_minion_die")),r=Object(s.createAnimation)(.1,e.findRegions("boss_projectile_A")),o=Object(s.createAnimation)(.15,e.findRegions("boss_projectile_B"));this.runAnimations=[t,a],this.deadAnimations=[i,n],this.projectileAnimations=[r,o],this.rockRegion=e.findRegion("rock",-1)}},{key:"process",value:function(){var e,t=this.batch,a=this.minions,i=this.runAnimations,n=this.deadAnimations,r=this.playerState,o=this.drawSize,l=this.projectileAnimations,h=Object(Ee.a)(a);try{for(h.s();!(e=h.n()).done;){var b=e.value;if(b.dead){if(this.front)continue}else{if(!this.front&&b.position.y>r.position.y-c.PLAYER_HEIGHT/4)continue;if(this.front&&b.position.y<=r.position.y-c.PLAYER_HEIGHT/4)continue}b.animationStateTime+=this.world.delta;var u=void 0;2===b.type?(u=this.rockRegion,o.set(115*c.ROCK_RADIUS/105,c.ROCK_RADIUS).scale(2)):b.type<=1?(o.set(c.ENEMY_RADIUS,c.ENEMY_RADIUS).scale(2),u=b.dead?n[b.type].getKeyFrame(b.animationStateTime,s.PlayMode.NORMAL):i[b.type].getKeyFrame(b.animationStateTime,s.PlayMode.LOOP)):3===b.type?(o.set(120*c.ENEMY_RADIUS/154,c.ENEMY_RADIUS).scale(1.5),u=l[0].getKeyFrame(b.animationStateTime,s.PlayMode.LOOP)):(o.set(144*c.ENEMY_RADIUS/196,c.ENEMY_RADIUS).scale(2),u=l[1].getKeyFrame(b.animationStateTime,s.PlayMode.NORMAL)),u&&(b.displayPosition=b.displayPosition||b.position.cpy(),this.tmp.setVector(b.position).subVector(b.displayPosition).scale(.1),b.displayPosition.addVector(this.tmp),u.draw(t,b.displayPosition.x-o.x/2,b.displayPosition.y-o.y/2,o.x,o.y))}}catch(d){h.e(d)}finally{h.f()}}}]),a}(He.System),ae=Object(Ne.a)(te.prototype,"batch",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ie=Object(Ne.a)(te.prototype,"assetManager",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ne=Object(Ne.a)(te.prototype,"minions",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),re=Object(Ne.a)(te.prototype,"playerState",[ee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),te),qe=(se=Object(He.Inject)("playerState"),oe=Object(He.Inject)("minions"),ce=function(e){Object(Me.a)(a,e);var t=Object(ke.a)(a);function a(){var e;Object(o.a)(this,a);for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return e=t.call.apply(t,[this].concat(n)),Object(xe.a)(e,"playerState",le,Object(Ce.a)(e)),Object(xe.a)(e,"minions",he,Object(Ce.a)(e)),e.generatedY=3*-c.BACKGROUND_HEIGHT,e.accumulate=0,e.generatedProjectiles=0,e}return Object(Te.a)(a,[{key:"generateBossProjectiles",value:function(){var e=this.minions,t=this.playerState;t.bossEnd||(this.accumulate+=this.world.delta,this.accumulate>=c.BOSS_ATTACK_RATE&&(this.accumulate=0,e.push({type:Math.random()>.5?3:4,animationStateTime:0,dead:!1,position:new s.Vector2(Math.random()>.5?c.PLAYER_X_TARGETS[0]:c.PLAYER_X_TARGETS[1],c.BOSS_Y+100),displayPosition:void 0}),this.generatedProjectiles+=1,this.generatedProjectiles>=c.BOSS_PROJECTILE_COUNT&&(t.bossEnd=!0,t.animationStateTime=0)))}},{key:"process",value:function(){var e=this.playerState,t=this.minions;for(e.encounterBoss&&this.generateBossProjectiles();e.position.y<this.generatedY+3*c.BACKGROUND_HEIGHT&&this.generatedY>=-c.BACKGROUND_HEIGHT*(c.LEVEL_COUNT-6);){for(var a=0;a<10;a++)if(Math.random()<.3){var i={animationStateTime:0,dead:!1,type:Math.random()>=.3?Math.random()>.5?0:1:2,position:new s.Vector2(Math.random()>.5?c.PLAYER_X_TARGETS[0]:c.PLAYER_X_TARGETS[1],this.generatedY-3*c.BACKGROUND_HEIGHT/10*a),displayPosition:void 0};t.push(i)}this.generatedY-=3*c.BACKGROUND_HEIGHT}for(var n=t.length-1;n>=0;n--){var r=t[n];!r.dead&&r.type<=1?r.position.set(r.position.x,r.position.y+c.ENEMY_SPEED_Y*this.world.delta):!r.dead&&r.type>=3&&r.position.set(r.position.x,r.position.y+10*c.ENEMY_SPEED_Y*this.world.delta),(r.position.y>e.position.y+2*c.BACKGROUND_HEIGHT||r.type>=3&&r.dead)&&t.splice(n,1)}}}]),a}(He.System),le=Object(Ne.a)(ce.prototype,"playerState",[se],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),he=Object(Ne.a)(ce.prototype,"minions",[oe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ce),Qe=(be=Object(He.Inject)("playerState"),ue=function(e){Object(Me.a)(a,e);var t=Object(ke.a)(a);function a(){var e;Object(o.a)(this,a);for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return e=t.call.apply(t,[this].concat(n)),Object(xe.a)(e,"playerState",de,Object(Ce.a)(e)),e.tmpVector=new s.Vector2(0,0),e.ended=!1,e.done=!1,e.accumulate=0,e}return Object(Te.a)(a,[{key:"process",value:function(){var e=this.playerState.position,t=this.playerState.velocity,a=c.BACKGROUND_START-(c.LEVEL_COUNT-1)*c.BACKGROUND_HEIGHT+c.CAMERA_GAP;if(this.playerState.knockBackDuration>0?(this.playerState.knockBackDuration-=this.world.delta,e.y>a&&t.set(t.x,c.PLAYER_KNOCKBACK_FORCE)):(this.playerState.knockBackDuration=0,e.y>a?t.set(t.x,c.PLAYER_SPEED_Y):this.playerState.bossKill||(t.set(t.x,0),e.set(e.x,a),this.playerState.encounterBoss=!0)),this.playerState.bossEnd){this.processPowerDecay(),this.playerState.dashing=!1;var i=e.x+.1*(c.WORLD_WIDTH/2-e.x);if(e.set(i,e.y),this.playerState.bossKill){var n=e.y+.1*(c.BOSS_Y+200-e.y);e.set(e.x,n),this.ended||(Fe("attack_03"),this.ended=!0)}t.set(0,0)}if(this.playerState.dashing){var r=this.playerState.targetX;0===r?e.x>c.PLAYER_X_TARGETS[0]?t.set(-c.PLAYER_DASH_SPEED,t.y):(t.set(0,t.y),e.set(c.PLAYER_X_TARGETS[0],e.y),this.playerState.dashing=!1):1===r?e.x<c.PLAYER_X_TARGETS[1]?t.set(c.PLAYER_DASH_SPEED,t.y):(t.set(0,t.y),e.set(c.PLAYER_X_TARGETS[1],e.y),this.playerState.dashing=!1):this.playerState.animationStateTime>=.5&&(this.playerState.dashing=!1,this.playerState.animationStateTime=0)}!this.done&&e.y-c.BOSS_Y<=250&&(this.playerState.score+=1e3,this.done=!0,Xe.emit("gameOver",!0)),this.tmpVector.setVector(t).scale(this.world.delta),e.addVector(this.tmpVector)}},{key:"processPowerDecay",value:function(){if(this.accumulate+=this.world.delta,!this.playerState.bossKill){for(;this.accumulate>=c.POWER_DEC_RATE;)this.playerState.power-=c.POWER_DEC,this.accumulate-=c.POWER_DEC_RATE;this.playerState.power=Math.max(c.MIN_POWER,this.playerState.power),this.playerState.power=Math.min(c.MAX_POWER,this.playerState.power),this.playerState.power===c.MAX_POWER&&(this.playerState.bossKill=!0,this.playerState.animationStateTime=0)}}}]),a}(He.System),de=Object(Ne.a)(ue.prototype,"playerState",[be],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ue),$e=(pe=Object(He.Inject)("playerState"),Oe=Object(He.Inject)("batch"),ye=Object(He.Inject)("whiteTex"),je=Object(He.Inject)("assetManager"),me=Object(He.Inject)("effects"),ge=function(e){Object(Me.a)(a,e);var t=Object(ke.a)(a);function a(){var e;Object(o.a)(this,a);for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return e=t.call.apply(t,[this].concat(n)),Object(xe.a)(e,"playerState",fe,Object(Ce.a)(e)),Object(xe.a)(e,"batch",Se,Object(Ce.a)(e)),Object(xe.a)(e,"whiteTex",_e,Object(Ce.a)(e)),Object(xe.a)(e,"assetManager",Ae,Object(Ce.a)(e)),Object(xe.a)(e,"effects",Re,Object(Ce.a)(e)),e.runAnimation=void 0,e.idleAnimation=void 0,e.dashAnimation=void 0,e.ultiAnimation=void 0,e.channelingAnimation=void 0,e.killingAnimation=void 0,e.drawSize=new s.Vector2(0,0),e.ultiScale=c.MIN_POWER,e.frame=0,e}return Object(Te.a)(a,[{key:"initialized",value:function(){var e=this.assetManager.getAtlas("./main.atlas"),t=e.findRegions("mina_run"),a=t.filter((function(e,t){return[3,4].includes(t)})),i=e.findRegions("mina_dash"),n=e.findRegions("mina_ulti");this.runAnimation=Object(s.createAnimation)(.1,t),this.idleAnimation=Object(s.createAnimation)(.5,a),this.dashAnimation=Object(s.createAnimation)(.05,i),this.ultiAnimation=Object(s.createAnimation)(.1,n.slice(0,7)),this.channelingAnimation=Object(s.createAnimation)(.1,n.slice(3,7)),this.killingAnimation=Object(s.createAnimation)(.04,n.slice(3,11))}},{key:"process",value:function(){var e;this.playerState.animationStateTime+=this.world.delta,this.frame++;var t=!1;this.playerState.bossKill?(this.drawSize.set(c.PLAYER_DRAW_WIDTH/180*290,c.PLAYER_DRAW_HEIGHT/180*259),e=this.killingAnimation.getKeyFrame(this.playerState.animationStateTime,s.PlayMode.NORMAL)):this.playerState.bossEnd?(e=this.playerState.animationStateTime<=.8?this.ultiAnimation.getKeyFrame(this.playerState.animationStateTime,s.PlayMode.NORMAL):this.channelingAnimation.getKeyFrame(this.playerState.animationStateTime,s.PlayMode.LOOP),this.drawSize.set(c.PLAYER_DRAW_WIDTH/180*290,c.PLAYER_DRAW_HEIGHT/180*259)):this.playerState.dashing?(this.drawSize.set(295/180*c.PLAYER_DRAW_WIDTH,c.PLAYER_DRAW_HEIGHT),e=this.dashAnimation.getKeyFrame(this.playerState.animationStateTime,s.PlayMode.NORMAL),1===this.playerState.targetX&&(t=!0),this.frame%4===0&&this.effects.push({type:"dash_smoke",position:new s.Vector2(this.playerState.position.x,this.playerState.position.y),duration:c.DASH_SMOKE_DURATION,elapsed:0,flip:1===this.playerState.targetX,size:new s.Vector2(c.DASH_SMOKE_SIZE,c.DASH_SMOKE_SIZE),data:void 0})):(this.drawSize.set(c.PLAYER_DRAW_WIDTH,c.PLAYER_DRAW_HEIGHT),e=this.playerState.velocity.y<0?this.runAnimation.getKeyFrame(this.playerState.animationStateTime,s.PlayMode.LOOP):this.idleAnimation.getKeyFrame(this.playerState.animationStateTime,s.PlayMode.LOOP)),this.playerState.knockBackDuration>0&&this.batch.setColor(1,1,1,1-this.playerState.knockBackDuration/c.KNOCKBACK_DURATION),e.draw(this.batch,this.playerState.position.x-this.drawSize.x/2,this.playerState.position.y-this.drawSize.y/2,this.drawSize.x,this.drawSize.y,this.drawSize.x/2,this.drawSize.y/2,0,t?-1:1),this.batch.setColor(1,1,1,1)}}]),a}(He.System),fe=Object(Ne.a)(ge.prototype,"playerState",[pe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Se=Object(Ne.a)(ge.prototype,"batch",[Oe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_e=Object(Ne.a)(ge.prototype,"whiteTex",[ye],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ae=Object(Ne.a)(ge.prototype,"assetManager",[je],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Re=Object(Ne.a)(ge.prototype,"effects",[me],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ge);function et(e,t,a,i,n,r,o){var l=new He.World,h={position:new s.Vector2(c.PLAYER_X_TARGETS[0],0),velocity:new s.Vector2(0,0),animationStateTime:0,encounterBoss:!1,targetX:c.PLAYER_X_TARGETS[0],dashing:!1,knockBackDuration:0,life:3,bossEnd:!1,power:0,bossKill:!1,score:0},b=o.getAtlas("./ui.atlas"),u=new Ie.Stage(t),d=b.findRegion("avatar",-1),p=b.findRegion("heart_full",-1),O=b.findRegion("heart_empty",-1),y=b.findRegion("score_label",-1),j=b.findRegion("gameOver",-1),m=b.findRegion("retry_btn",-1),g=o.getFont("./score.fnt"),f=o.getFont("./score_result.fnt"),S=!1,_=function(){var e=Object(Pe.useState)(3),t=Object(De.a)(e,2),a=t[0],i=t[1],n=Object(Pe.useState)(0),r=Object(De.a)(n,2),s=r[0],o=r[1];return Object(Pe.useEffect)((function(){return Xe.on("life",i),Xe.on("score",o),function(){Xe.off("life",i),Xe.off("score",o)}}),[]),Object(ve.jsxs)(Ie.RActor,{style:{flex:1,paddingTop:15,paddingRight:15,alignItems:Le.ALIGN_FLEX_END},children:[Object(ve.jsxs)(Ie.RActor,{style:{flexDirection:"row"},children:[Object(ve.jsxs)(Ie.RActor,{style:{flexDirection:"column",alignItems:Le.ALIGN_FLEX_END},children:[Object(ve.jsx)(Ie.RImage,{region:y,style:{height:40,width:40/17*63}}),Object(ve.jsx)(Ie.RLabel,{font:g,text:s.toString(),align:Ie.LabelAlign.right,style:{height:40,width:200}})]}),Object(ve.jsx)(Ie.RImage,{style:{width:100,height:100,marginLeft:10},region:d})]}),Object(ve.jsx)(Ie.RActor,{style:{flex:1,paddingTop:10,flexDirection:"row"},children:[2,1,0].map((function(e){return Object(ve.jsx)(Ie.RImage,{region:e<a?p:O,style:{width:40,height:40,marginLeft:5}},e)}))})]})},A=function(){var s=Object(Pe.useState)(!1),l=Object(De.a)(s,2),b=l[0],u=l[1];return Object(Pe.useEffect)((function(){Xe.once("gameOver",(function(e){S=!0,u(!0),e&&Fe("end")}))}),[]),b?Object(ve.jsx)(Ie.RActor,{style:{flex:1,justifyContent:Le.JUSTIFY_FLEX_END,alignItems:Le.ALIGN_CENTER},children:Object(ve.jsxs)(Ie.RImage,{region:j,style:{width:c.WORLD_WIDTH,height:450*c.WORLD_WIDTH/300,alignItems:Le.ALIGN_CENTER},children:[Object(ve.jsx)(Ie.RLabel,{font:f,text:h.score.toString(),align:Ie.LabelAlign.center,style:{marginTop:180,width:c.WORLD_WIDTH,height:90}}),Object(ve.jsx)(Ie.RImageButton,{upRegion:m,downRegion:m,style:{marginTop:20,height:30,width:320},onTouchEnd:function(){e.setScreen(et(e,t,a,i,n,r,o))}})]})}):Object(ve.jsx)(_,{})};Ie.ReactGdxjsStageRenderer.render(Object(ve.jsx)(A,{}),new Ie.StageWrapper(u));return l.register("playerState",h),l.register("camera",a),l.register("batch",n),l.register("whiteTex",r),l.register("assetManager",o),l.register("viewport",t),l.register("effects",[]),l.register("minions",[]),l.addSystem(new Ve),l.addSystem(new Qe),l.addSystem(new qe),l.addSystem(new Je),l.addSystem(new Ke),l.addSystem(new Ge,!1),l.addSystem(new Ye,!1),l.addSystem(new We,!1),l.addSystem(new Ze(!1),!1),l.addSystem(new $e,!1),l.addSystem(new Ze(!0),!1),Fe("start"),Ue.playing()&&Ue.stop(),Ue.volume(.3),Ue.play(),{dispose:function(){u.dispose(),l.dispose()},update:function(e){n.setProjection(i.combined),n.begin(),n.setColor(0,0,0,1),Object(s.fillRect)(n,r,0,0,c.WORLD_WIDTH,c.WORLD_HEIGHT),n.setColor(1,1,1,1),n.end(),n.setProjection(a.combined),n.begin(),l.setDelta(e),S?l.setDelta(0):l.processActiveSystem(),l.processPassiveSystem(),n.end(),S&&(n.setProjection(i.combined),n.begin(),n.setColor(0,0,0,.75),Object(s.fillRect)(n,r,0,-c.WORLD_HEIGHT/2,c.WORLD_WIDTH,2*c.WORLD_HEIGHT),n.setColor(1,1,1,1),n.end()),u.act(e),u.draw()}}}function tt(e,t,a,i,n,r,s){var o=s.getAtlas("./tutorial.atlas"),c=new Ie.Stage(t),l=o.findRegions("tut"),h=o.findRegion("next",-1),b=o.findRegion("skip",-1),u=function(){var o=Object(Pe.useState)(0),c=Object(De.a)(o,2),u=c[0],d=c[1];return Object(ve.jsx)(Ie.RActor,{style:{flex:1,alignItems:Le.ALIGN_CENTER,justifyContent:Le.JUSTIFY_CENTER},children:Object(ve.jsxs)(Ie.RImage,{region:l[u],style:{width:"90%",aspectRatio:300/450,alignItems:Le.ALIGN_FLEX_END,paddingBottom:"25%",flexDirection:"row"},children:[Object(ve.jsx)(Ie.RActor,{style:{width:"5%"}}),Object(ve.jsx)(Ie.RImageButton,{style:{height:"5%",aspectRatio:3.45,marginBottom:"0.3%"},upRegion:h,downRegion:h,onTouchEnd:function(){return d(0===u?1:0)}}),Object(ve.jsx)(Ie.RActor,{style:{width:"5%"}}),Object(ve.jsx)(Ie.RImageButton,{style:{height:"5%",aspectRatio:71/22},upRegion:b,downRegion:b,onTouchEnd:function(){return e.setScreen(et(e,t,a,i,n,r,s))}})]})})};return Ie.ReactGdxjsStageRenderer.render(Object(ve.jsx)(u,{}),new Ie.StageWrapper(c)),{update:function(e){c.act(e),c.draw()},dispose:function(){c.dispose()}}}(function(){var e=Object(r.a)(n.a.mark((function e(){var t,a,i,r,o,l,h,b,u,d,p;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=Object(s.createStage)(),a=t.getCanvas(),i=Object(s.createViewport)(a,c.WORLD_WIDTH,c.WORLD_HEIGHT,{crop:!1,autoUpdate:!0,pixelRatio:1}),r=Object(s.createOrthoCamera)(c.WORLD_WIDTH,c.WORLD_HEIGHT,a.width,a.height),i.addCamera(r),i.update(),o=i.getCamera(),l=i.getContext(),h=Object(s.createBatch)(l),b=Object(s.createWhiteTexture)(l),u=new we(l),d=0;d<8;d++)u.loadTexture("./background/bg_0".concat(d+1,".jpg"));return u.loadAtlas("./tutorial.atlas"),u.loadAtlas("./main.atlas"),u.loadAtlas("./enemy.atlas"),u.loadAtlas("./ui.atlas"),u.loadFont("./score.fnt"),u.loadFont("./score_result.fnt"),e.next=20,u.finishLoading();case 20:(p=new s.Game).setScreen(tt(p,i,o,r,h,b,u)),l.clearColor(.1,.1,.1,1),Object(s.createGameLoop)((function(e){l.clear(l.COLOR_BUFFER_BIT),p.update(e,null)}));case 24:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()},81:function(e,t,a){}},[[117,1,2]]]);